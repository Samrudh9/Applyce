{% extends "admin/base.html" %}

{% block title %}System Health{% endblock %}

{% block content %}
<div class="page-header">
  <h1>üñ•Ô∏è System Health</h1>
  <p>Monitor system status and database metrics</p>
</div>

<!-- System Metrics (if available) -->
{% if system_stats %}
<div class="card">
  <div class="card-header">
    <h2><i class="fas fa-heartbeat"></i> System Resources</h2>
  </div>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
    <div style="padding: 1rem; background: rgba(255, 255, 255, 0.02); border-radius: 10px; border: 1px solid var(--border-color);">
      <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
        <div style="width: 40px; height: 40px; background: rgba(0, 194, 255, 0.15); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: var(--accent);">
          <i class="fas fa-microchip"></i>
        </div>
        <div>
          <div style="font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px;">CPU Usage</div>
          <div style="font-size: 1.5rem; font-weight: 700; color: #fff;">{{ system_stats.cpu_percent }}%</div>
        </div>
      </div>
      <div style="height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
        <div style="height: 100%; width: {{ system_stats.cpu_percent }}%; background: {% if system_stats.cpu_percent > 80 %}var(--error){% elif system_stats.cpu_percent > 60 %}var(--warning){% else %}var(--accent){% endif %};"></div>
      </div>
    </div>

    <div style="padding: 1rem; background: rgba(255, 255, 255, 0.02); border-radius: 10px; border: 1px solid var(--border-color);">
      <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
        <div style="width: 40px; height: 40px; background: rgba(0, 255, 136, 0.15); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: var(--success);">
          <i class="fas fa-memory"></i>
        </div>
        <div>
          <div style="font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px;">Memory Usage</div>
          <div style="font-size: 1.5rem; font-weight: 700; color: #fff;">{{ system_stats.memory_percent }}%</div>
        </div>
      </div>
      <div style="height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
        <div style="height: 100%; width: {{ system_stats.memory_percent }}%; background: {% if system_stats.memory_percent > 80 %}var(--error){% elif system_stats.memory_percent > 60 %}var(--warning){% else %}var(--success){% endif %};"></div>
      </div>
    </div>

    <div style="padding: 1rem; background: rgba(255, 255, 255, 0.02); border-radius: 10px; border: 1px solid var(--border-color);">
      <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
        <div style="width: 40px; height: 40px; background: rgba(255, 170, 0, 0.15); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: var(--warning);">
          <i class="fas fa-hdd"></i>
        </div>
        <div>
          <div style="font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px;">Disk Usage</div>
          <div style="font-size: 1.5rem; font-weight: 700; color: #fff;">{{ system_stats.disk_percent }}%</div>
        </div>
      </div>
      <div style="height: 8px; background: rgba(255, 255, 255, 0.1); border-radius: 4px; overflow: hidden;">
        <div style="height: 100%; width: {{ system_stats.disk_percent }}%; background: {% if system_stats.disk_percent > 80 %}var(--error){% elif system_stats.disk_percent > 60 %}var(--warning){% else %}var(--warning){% endif %};"></div>
      </div>
    </div>
  </div>
</div>
{% else %}
<div class="card">
  <div class="card-header">
    <h2><i class="fas fa-heartbeat"></i> System Resources</h2>
  </div>
  <div style="text-align: center; padding: 2rem; color: var(--text-muted);">
    <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
    <p>System resource monitoring not available. Install <code>psutil</code> to enable this feature.</p>
    <pre style="margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.05); border-radius: 8px; display: inline-block;">pip install psutil</pre>
  </div>
</div>
{% endif %}

<!-- Database Statistics -->
<div class="card">
  <div class="card-header">
    <h2><i class="fas fa-database"></i> Database Statistics</h2>
  </div>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;">
    <div style="padding: 1.5rem; background: rgba(255, 255, 255, 0.02); border-radius: 10px; border: 1px solid var(--border-color); text-align: center;">
      <div style="width: 56px; height: 56px; background: rgba(0, 194, 255, 0.15); border-radius: 14px; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: var(--accent); font-size: 1.5rem;">
        <i class="fas fa-users"></i>
      </div>
      <div style="font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.5rem;">Users</div>
      <div style="font-size: 2rem; font-weight: 700; color: #fff;">{{ db_stats.users }}</div>
    </div>

    <div style="padding: 1.5rem; background: rgba(255, 255, 255, 0.02); border-radius: 10px; border: 1px solid var(--border-color); text-align: center;">
      <div style="width: 56px; height: 56px; background: rgba(255, 170, 0, 0.15); border-radius: 14px; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: var(--warning); font-size: 1.5rem;">
        <i class="fas fa-file-alt"></i>
      </div>
      <div style="font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.5rem;">Resumes</div>
      <div style="font-size: 2rem; font-weight: 700; color: #fff;">{{ db_stats.resumes }}</div>
    </div>

    <div style="padding: 1.5rem; background: rgba(255, 255, 255, 0.02); border-radius: 10px; border: 1px solid var(--border-color); text-align: center;">
      <div style="width: 56px; height: 56px; background: rgba(0, 255, 136, 0.15); border-radius: 14px; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: var(--success); font-size: 1.5rem;">
        <i class="fas fa-comments"></i>
      </div>
      <div style="font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.5rem;">Feedback</div>
      <div style="font-size: 2rem; font-weight: 700; color: #fff;">{{ db_stats.feedback }}</div>
    </div>

    <div style="padding: 1.5rem; background: rgba(255, 255, 255, 0.02); border-radius: 10px; border: 1px solid var(--border-color); text-align: center;">
      <div style="width: 56px; height: 56px; background: rgba(168, 85, 247, 0.15); border-radius: 14px; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: var(--accent-purple); font-size: 1.5rem;">
        <i class="fas fa-brain"></i>
      </div>
      <div style="font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.5rem;">Skill Patterns</div>
      <div style="font-size: 2rem; font-weight: 700; color: #fff;">{{ db_stats.patterns }}</div>
    </div>
  </div>
</div>

<!-- Health Status -->
<div class="card">
  <div class="card-header">
    <h2><i class="fas fa-check-circle"></i> Health Status</h2>
  </div>
  <div style="display: grid; gap: 1rem;">
    <div style="display: flex; align-items: center; justify-content: space-between; padding: 1rem; background: rgba(0, 255, 136, 0.1); border-radius: 10px; border: 1px solid rgba(0, 255, 136, 0.3);">
      <div style="display: flex; align-items: center; gap: 0.75rem;">
        <i class="fas fa-check-circle" style="color: var(--success); font-size: 1.25rem;"></i>
        <span style="font-weight: 500;">Database Connection</span>
      </div>
      <span class="badge badge-success">Online</span>
    </div>

    <div style="display: flex; align-items: center; justify-content: space-between; padding: 1rem; background: rgba(0, 255, 136, 0.1); border-radius: 10px; border: 1px solid rgba(0, 255, 136, 0.3);">
      <div style="display: flex; align-items: center; gap: 0.75rem;">
        <i class="fas fa-check-circle" style="color: var(--success); font-size: 1.25rem;"></i>
        <span style="font-weight: 500;">Application Server</span>
      </div>
      <span class="badge badge-success">Running</span>
    </div>

    <div style="display: flex; align-items: center; justify-content: space-between; padding: 1rem; background: rgba(0, 255, 136, 0.1); border-radius: 10px; border: 1px solid rgba(0, 255, 136, 0.3);">
      <div style="display: flex; align-items: center; gap: 0.75rem;">
        <i class="fas fa-check-circle" style="color: var(--success); font-size: 1.25rem;"></i>
        <span style="font-weight: 500;">Admin Panel</span>
      </div>
      <span class="badge badge-success">Accessible</span>
    </div>
  </div>
</div>

<!-- Quick Actions -->
<div class="card">
  <div class="card-header">
    <h2><i class="fas fa-tools"></i> Quick Actions</h2>
  </div>
  <div style="display: flex; flex-wrap: wrap; gap: 1rem;">
    <a href="{{ url_for('admin_backup_page') }}" class="btn btn-primary">
      <i class="fas fa-database"></i> Create Backup
    </a>
    <a href="{{ url_for('admin_dashboard') }}" class="btn btn-secondary">
      <i class="fas fa-sync"></i> Refresh Dashboard
    </a>
    <a href="{{ url_for('home') }}" class="btn btn-secondary">
      <i class="fas fa-home"></i> View Application
    </a>
  </div>
</div>
{% endblock %}
