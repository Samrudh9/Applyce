<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Job Search | Applyce</title>
  <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
</head>
<body>
  {% include 'components/navbar.html' %}

  <main class="section">
    <div class="container">
      <div class="section-header">
        <div>
          <p class="section-subtitle">Job Search</p>
          <h1 class="section-title">Find roles aligned with your AI career match.</h1>
          <p class="helper-text">Search thousands of roles with precision filtering and AI fit scores.</p>
        </div>
      </div>

      <div class="glass card" style="margin-top:2rem;">
        <form class="job-search-form" method="GET" action="/jobs">
          <div class="input-group">
            <input class="input-field" type="text" name="job_title" placeholder=" " value="{{ request.args.get('job_title', '') }}" />
            <label class="floating-label">Job Title</label>
          </div>
          <div class="input-group">
            <input class="input-field" type="text" name="location" placeholder=" " value="{{ request.args.get('location', '') }}" />
            <label class="floating-label">Location</label>
          </div>
          <label class="checkbox-row" style="margin-bottom:1.5rem;">
            <input type="checkbox" name="remote_only" {% if request.args.get('remote_only') %}checked{% endif %} /> Remote Only
          </label>
          <button class="btn btn-primary" type="submit">Search Jobs</button>
        </form>
      </div>

      <div class="section" style="padding-top:2.5rem;">
        <div class="stats-grid">
          <div class="glass card stats-card">
            <p class="helper-text">Open Positions</p>
            <h3>12,500</h3>
            <span class="badge-success">+8% this month</span>
          </div>
          <div class="glass card stats-card">
            <p class="helper-text">Growth Rate</p>
            <h3>18%</h3>
            <span class="badge">Stable</span>
          </div>
          <div class="glass card stats-card">
            <p class="helper-text">Demand Level</p>
            <h3>High</h3>
            <span class="badge-purple">Top tier</span>
          </div>
          <div class="glass card stats-card">
            <p class="helper-text">Remote %</p>
            <h3>42%</h3>
            <span class="badge">Remote friendly</span>
          </div>
          <div class="glass card stats-card">
            <p class="helper-text">Salary Range</p>
            <h3>$95k - $135k</h3>
            <span class="badge-success">Median $118k</span>
          </div>
        </div>
      </div>

      <div class="section" style="padding-top:2.5rem;">
        <div class="grid" style="display:grid; gap:2rem; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));">
          <div class="glass card">
            <h2>Hot Skills</h2>
            <div class="chip-list" style="margin-top:1.5rem;">
              <span class="tag tag-green">AI Product Strategy</span>
              <span class="tag tag-green">Prompt Engineering</span>
              <span class="tag tag-green">Product Analytics</span>
              <span class="tag tag-green">Leadership</span>
              <span class="tag tag-green">Go-to-market</span>
            </div>
          </div>
          <div class="glass card">
            <h2>Top Hiring Companies</h2>
            <div class="chip-list" style="margin-top:1.5rem;">
              <span class="badge">Meta</span>
              <span class="badge">Google</span>
              <span class="badge">OpenAI</span>
              <span class="badge">Stripe</span>
              <span class="badge">Airbnb</span>
            </div>
          </div>
        </div>
      </div>

      <div class="section" style="padding-top:2.5rem;">
        <div class="section-header">
          <h2>Job Listings</h2>
          <span class="badge">AI matched</span>
        </div>
        <div class="icon-grid" style="margin-top:2rem;">
          {% for job in matching_jobs %}
          <div class="glass card job-card">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <div>
                <h3>{{ job.title }}</h3>
                <p class="helper-text">{{ job.company }}</p>
              </div>
              <span class="badge-success">{{ job.match_score or 92 }}% Match</span>
            </div>
            <p style="margin-top:0.75rem;">{{ job.location }} Â· {{ job.salary or 'Salary Competitive' }}</p>
            <div class="chip-list" style="margin-top:1rem;">
              {% for skill in job.matching_skills or [] %}
                <span class="tag tag-green">{{ skill }}</span>
              {% endfor %}
              {% for skill in job.missing_skills or [] %}
                <span class="tag tag-red">{{ skill }}</span>
              {% endfor %}
            </div>
            <div style="display:flex; gap:1rem; margin-top:1.5rem; flex-wrap:wrap;">
              <a class="btn btn-primary" href="{{ job.apply_url or '#' }}">Apply Now</a>
              <button class="btn btn-outline" type="button" data-modal="jobFitModal" data-job="{{ job.title }}">Check Job Fit</button>
              <span class="badge">{{ job.source or 'LinkedIn' }}</span>
            </div>
          </div>
          {% else %}
          <div class="glass card">
            <h3>No jobs found yet</h3>
            <p class="helper-text">Search for a role to see AI-matched listings.</p>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </main>

  <div class="modal" id="jobFitModal" aria-hidden="true">
    <div class="modal-content glass card">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <h3>Job Fit Analysis</h3>
        <button class="btn btn-outline" data-close>Close</button>
      </div>
      <p class="helper-text">Role: <span id="modalJobTitle">AI Product Manager</span></p>
      <div class="grid" style="display:grid; gap:1.5rem; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); margin-top:1.5rem;">
        <div>
          <h4>Matching Skills</h4>
          <div class="chip-list">
            <span class="tag tag-green">Product strategy</span>
            <span class="tag tag-green">Analytics</span>
            <span class="tag tag-green">AI roadmap</span>
          </div>
        </div>
        <div>
          <h4>Skills to Build</h4>
          <div class="chip-list">
            <span class="tag tag-orange">Prompt design</span>
            <span class="tag tag-orange">Leadership coaching</span>
          </div>
        </div>
      </div>
      <div class="glass-soft card" style="margin-top:1.5rem;">
        <p><i class="fas fa-lightbulb"></i> Recommendation: Focus on advanced AI experimentation to push match score above 95%.</p>
      </div>
    </div>
  </div>

  {% include 'components/footer.html' %}

  <style>
    .job-search-form {
      display: grid;
      gap: 1.25rem;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      align-items: end;
    }

    .job-card h3 {
      margin: 0;
    }

    .modal {
      position: fixed;
      inset: 0;
      background: rgba(5, 6, 12, 0.7);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      z-index: 1200;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      width: min(720px, 90vw);
    }
  </style>

  <script>
    const modal = document.getElementById('jobFitModal');
    const modalTitle = document.getElementById('modalJobTitle');

    document.querySelectorAll('[data-modal="jobFitModal"]').forEach(button => {
      button.addEventListener('click', () => {
        modalTitle.textContent = button.dataset.job || 'Job Fit Analysis';
        modal.classList.add('active');
        modal.setAttribute('aria-hidden', 'false');
      });
    });

    document.querySelectorAll('[data-close]').forEach(button => {
      button.addEventListener('click', () => {
        modal.classList.remove('active');
        modal.setAttribute('aria-hidden', 'true');
      });
    });

    if (modal) {
      modal.addEventListener('click', (event) => {
        if (event.target === modal) {
          modal.classList.remove('active');
          modal.setAttribute('aria-hidden', 'true');
        }
      });
    }
  </script>
</body>
</html>
